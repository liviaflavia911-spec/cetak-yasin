---
import { getCollection } from 'astro:content';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.map(post => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();

// Get all posts for related posts section
const posts = await getCollection('blog');
---

<html lang="id">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width" />
		<meta name="generator" content={Astro.generator} />
		<meta name="description" content={post.data.excerpt} />
		<title>{post.data.title} - CetakYasin.id</title>
	</head>
	<body class="bg-gray-50">
		<Header />
		
		<main class="pt-28">
			<!-- Breadcrumb -->
			<div class="container mx-auto px-4">
				<div class="py-4">
					<a href="/blog" class="text-teal-600 hover:text-teal-700 inline-flex items-center">
						<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
						</svg>
						Kembali ke Blog
					</a>
				</div>
			</div>

			<article class="container mx-auto px-4 py-8 max-w-4xl">
				<div class="bg-white rounded-2xl shadow-sm overflow-hidden">
					<img 
						src={post.data.image}
						alt={post.data.title}
						class="w-full h-64 md:h-96 object-cover"
					/>
					<div class="p-8">
						<h1 class="text-4xl font-bold text-gray-900 mb-4">
							{post.data.title}
						</h1>
						<div class="flex items-center text-gray-600 mb-8">
							<span class="text-sm">
								{new Date(post.data.publishedDate).toLocaleDateString('id-ID', {
									year: 'numeric',
									month: 'long',
									day: 'numeric'
								})}
							</span>
							<span class="mx-2">â€¢</span>
							<span class="text-sm">{post.data.author}</span>
						</div>

						<!-- Social Share Buttons -->
						<div class="flex items-center space-x-4 mb-8 border-b border-gray-100 pb-6">
							<span class="text-gray-600 text-sm">Bagikan:</span>
							<a href={`https://www.facebook.com/sharer/sharer.php?u=${Astro.url}`} target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:text-blue-700">
								<span class="sr-only">Bagikan di Facebook</span>
								<svg class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24">
									<path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/>
								</svg>
							</a>
							<a href={`https://twitter.com/intent/tweet?url=${Astro.url}&text=${encodeURIComponent(post.data.title)}`} target="_blank" rel="noopener noreferrer" class="text-blue-400 hover:text-blue-500">
								<span class="sr-only">Bagikan di Twitter</span>
								<svg class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24">
									<path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/>
								</svg>
							</a>
							<a href={`https://wa.me/?text=${encodeURIComponent(post.data.title + ' ' + Astro.url)}`} target="_blank" rel="noopener noreferrer" class="text-green-600 hover:text-green-700">
								<span class="sr-only">Bagikan di WhatsApp</span>
								<svg class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24">
									<path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
								</svg>
							</a>
						</div>

						<div class="blog-content prose prose-lg max-w-none prose-teal">
							<Content />
						</div>
					</div>
				</div>
			</article>

			<!-- Related Posts -->
			{posts.length > 1 && (
				<div class="container mx-auto px-4 py-16 max-w-4xl">
					<h2 class="text-2xl font-bold text-gray-900 mb-8">Artikel Terkait</h2>
					<div class="grid grid-cols-1 md:grid-cols-2 gap-8">
						{posts
							.filter(p => p.slug !== post.slug)
							.slice(0, 2)
							.map(relatedPost => (
								<article class="bg-white rounded-lg shadow-sm overflow-hidden">
									<a href={`/blog/${relatedPost.slug}`} class="block">
										<img 
											src={relatedPost.data.image}
											alt={relatedPost.data.title}
											class="w-full h-48 object-cover"
										/>
										<div class="p-6">
											<h3 class="text-xl font-bold text-gray-900 mb-2">
												{relatedPost.data.title}
											</h3>
											<p class="text-gray-600 text-sm mb-4">
												{new Date(relatedPost.data.publishedDate).toLocaleDateString('id-ID', {
													year: 'numeric',
													month: 'long',
													day: 'numeric'
												})}
											</p>
											<p class="text-gray-700">
												{relatedPost.data.excerpt}
											</p>
										</div>
									</a>
								</article>
							))
						}
					</div>
				</div>
			)}
						</div>
						<style is:global>
							.blog-content {
								line-height: 1.8;
							}
							.blog-content h1 {
								font-size: 2.5em;
								margin: 1em 0;
								font-weight: bold;
							}
							.blog-content h2 {
								font-size: 2em;
								margin: 0.8em 0;
								font-weight: bold;
							}
							.blog-content h3 {
								font-size: 1.5em;
								margin: 0.6em 0;
								font-weight: bold;
							}
							.blog-content p {
								margin: 1.2em 0;
							}
							.blog-content ul, .blog-content ol {
								margin: 1.2em 0;
								padding-left: 2em;
							}
							.blog-content li {
								margin: 0.5em 0;
							}
							.blog-content img {
								max-width: 100%;
								height: auto;
								margin: 1.5em 0;
							}
							.blog-content a {
								color: #0d9488;
								text-decoration: underline;
							}
							.blog-content blockquote {
								border-left: 4px solid #e5e7eb;
								padding-left: 1em;
								margin: 1.5em 0;
								font-style: italic;
							}
							.blog-content pre {
								background: #f3f4f6;
								padding: 1em;
								border-radius: 0.375rem;
								overflow-x: auto;
								font-size: 0.875em;
							}
							.blog-content code {
								background: #f3f4f6;
								padding: 0.2em 0.4em;
								border-radius: 0.25em;
								font-size: 0.875em;
							}
							.blog-content table {
								width: 100%;
								border-collapse: collapse;
								margin: 1.5em 0;
							}
							.blog-content th, .blog-content td {
								border: 1px solid #e5e7eb;
								padding: 0.75em;
								text-align: left;
							}
							.blog-content th {
								background: #f9fafb;
								font-weight: 600;
							}
							.blog-content tr:nth-child(even) {
								background: #f9fafb;
							}
							.blog-content hr {
								border: 0;
								border-top: 1px solid #e5e7eb;
								margin: 2em 0;
								padding: 1em;
								border-radius: 0.5em;
								overflow-x: auto;
								margin: 1.5em 0;
							}
							.blog-content code {
								background: #f3f4f6;
								padding: 0.2em 0.4em;
								border-radius: 0.25em;
							}
						</style>
					</div>
						
				</div>
			</article>
		</main>

		<Footer />

		<style is:global>
			.prose img {
				border-radius: 0.5rem;
			}
		</style>
	</body>
</html>